"use strict";exports.id=601,exports.ids=[601],exports.modules={2502:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},8128:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(2502),exports),__exportStar(__webpack_require__(6903),exports),__exportStar(__webpack_require__(2041),exports)},6903:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequestLightClient=void 0;const guards_1=__webpack_require__(6202),clients_1=__webpack_require__(6502),defaultHeaders={"user-agent":"vscode-versionlens (gitlab.com/versionlens/vscode-versionlens)"};exports.RequestLightClient=class{xhr;options;logger;constructor(xhr,options,logger){this.xhr=xhr,this.options=options,this.logger=logger,(0,guards_1.throwUndefinedOrNull)("xhr",xhr),(0,guards_1.throwUndefinedOrNull)("options",options),(0,guards_1.throwUndefinedOrNull)("logger",logger)}async request(method,baseUrl,query={},headers={}){const url=clients_1.UrlUtils.createUrl(baseUrl,query);try{const response=await this.xhr({url,type:method,headers:Object.assign({},headers,defaultHeaders),strictSSL:this.options.http.strictSSL});return{source:clients_1.ClientResponseSource.remote,status:response.status,data:response.responseText,rejected:!1}}catch(error){const errorResponse=error;throw{source:clients_1.ClientResponseSource.remote,status:errorResponse.status,data:errorResponse.responseText,rejected:!0}}}}},2041:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createJsonClient=exports.createHttpClient=void 0;const clients_1=__webpack_require__(6502),RequireLight=__importStar(__webpack_require__(6283)),requestLightClient_1=__webpack_require__(6903);function createHttpClient(options,logger){return new requestLightClient_1.RequestLightClient(RequireLight.xhr,options,logger)}exports.createHttpClient=createHttpClient,exports.createJsonClient=function(options,logger){return new clients_1.JsonHttpClient(createHttpClient(options,logger))}},6421:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},7422:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(6421),exports),__exportStar(__webpack_require__(1493),exports),__exportStar(__webpack_require__(9398),exports)},1493:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PromiseSpawnClient=void 0;const guards_1=__webpack_require__(6202),clients_1=__webpack_require__(6502);exports.PromiseSpawnClient=class{promiseSpawnFn;processCache;cachingOptions;logger;constructor(promiseSpawnFn,processCache,cachingOptions,logger){this.promiseSpawnFn=promiseSpawnFn,this.processCache=processCache,this.cachingOptions=cachingOptions,this.logger=logger,(0,guards_1.throwUndefinedOrNull)("promiseSpawnFn",promiseSpawnFn),(0,guards_1.throwUndefinedOrNull)("processCache",processCache),(0,guards_1.throwUndefinedOrNull)("cachingOptions",cachingOptions),(0,guards_1.throwUndefinedOrNull)("logger",logger)}async request(cmd,args,cwd){const cacheKey=`${cmd} ${args.join(" ")}`;this.logger.silly("executing %s",cacheKey);try{let source=clients_1.ClientResponseSource.cache;const result=await this.processCache.getOrCreate(cacheKey,(async()=>(source=clients_1.ClientResponseSource.cli,await this.promiseSpawnFn(cmd,args,{cwd,stdioString:!0}))),this.cachingOptions.duration);return this.logger.debug("command result from %s - '%s'",source,cacheKey),{data:result.stdout,source,status:result.code,rejected:!1}}catch(error){throw{data:error.message,source:clients_1.ClientResponseSource.cli,status:error.code,rejected:!0}}}}},9398:function(__unused_webpack_module,exports,__webpack_require__){var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.createProcessClient=void 0;const promise_spawn_1=__importDefault(__webpack_require__(8162)),promiseSpawnClient_1=__webpack_require__(1493);exports.createProcessClient=function(processCache,cachingOpts,logger){return new promiseSpawnClient_1.PromiseSpawnClient(promise_spawn_1.default,processCache,cachingOpts,logger)}},601:function(__unused_webpack_module,exports,__webpack_require__){var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);desc&&!("get"in desc?!m.__esModule:desc.writable||desc.configurable)||(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(__webpack_require__(2701),exports),__exportStar(__webpack_require__(8056),exports),__exportStar(__webpack_require__(2101),exports),__exportStar(__webpack_require__(3549),exports),__exportStar(__webpack_require__(1896),exports),__exportStar(__webpack_require__(5681),exports),__exportStar(__webpack_require__(4760),exports),__exportStar(__webpack_require__(4983),exports),__exportStar(__webpack_require__(5524),exports),__exportStar(__webpack_require__(6518),exports),__exportStar(__webpack_require__(2626),exports)},2701:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.MavenClient=void 0;const guards_1=__webpack_require__(6202),clients_1=__webpack_require__(6502),packages_1=__webpack_require__(7074),mavenXmlUtils_1=__webpack_require__(2626);exports.MavenClient=class{config;httpClient;logger;constructor(config,httpClient,logger){this.config=config,this.httpClient=httpClient,this.logger=logger,(0,guards_1.throwUndefinedOrNull)("config",config),(0,guards_1.throwUndefinedOrNull)("httpClient",httpClient),(0,guards_1.throwUndefinedOrNull)("logger",logger)}async fetchPackage(request){const requestedPackage=request.dependency.package,semverSpec=packages_1.VersionUtils.parseSemver(requestedPackage.version),{repositories}=request.clientData,url=repositories[0].url;let[group,artifact]=requestedPackage.name.split(":");const queryUrl=`${url}${group.replace(/\./g,"/")+"/"+artifact}/maven-metadata.xml`;try{return await this.createRemotePackageDocument(queryUrl,request,semverSpec)}catch(error){const errorResponse=error;this.logger.debug("Caught exception from %s: %O",packages_1.PackageSourceType.Registry,errorResponse);const suggestion=packages_1.SuggestionFactory.createFromHttpStatus(errorResponse.status);if(null!=suggestion)return packages_1.ClientResponseFactory.create(packages_1.PackageSourceType.Registry,errorResponse,[suggestion]);throw errorResponse}}async createRemotePackageDocument(url,request,semverSpec){const httpResponse=await this.httpClient.request(clients_1.HttpClientRequestMethods.get,url,{},{}),{data}=httpResponse,source=packages_1.PackageSourceType.Registry,versionRange=semverSpec.rawVersion,requestedPackage=request.dependency.package,responseStatus={source:httpResponse.source,status:httpResponse.status},rawVersions=(0,mavenXmlUtils_1.getVersionsFromPackageXml)(data),semverVersions=packages_1.VersionUtils.filterSemverVersions(rawVersions),{releases,prereleases}=packages_1.VersionUtils.splitReleasesFromArray(semverVersions,this.config.prereleaseTagFilter),resolved={name:requestedPackage.name,version:versionRange},suggestions=(0,packages_1.createSuggestions)(versionRange,releases,prereleases);return{source,responseStatus,type:semverSpec.type,resolved,suggestions}}}},8056:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.MvnCli=void 0;const guards_1=__webpack_require__(6202),clients_1=__webpack_require__(6502),mavenXmlUtils_1=__webpack_require__(2626);exports.MvnCli=class{config;processClient;logger;constructor(config,processClient,logger){this.config=config,this.processClient=processClient,this.logger=logger,(0,guards_1.throwUndefinedOrNull)("config",config),(0,guards_1.throwUndefinedOrNull)("processClient",processClient),(0,guards_1.throwUndefinedOrNull)("logger",logger)}async fetchRepositories(cwd){let repos;try{const result=await this.processClient.request("mvn ",["help:effective-settings"],cwd),{data}=result;if(0===data.length)return[];repos=(0,mavenXmlUtils_1.extractReposUrlsFromXml)(data)}catch(err){repos=[]}return 0===repos.length&&repos.push("https://repo.maven.apache.org/maven2/"),repos.map((url=>({url,protocol:clients_1.UrlUtils.getProtocolFromUrl(url)})))}}},8541:(__unused_webpack_module,exports)=>{var MavenContributions;Object.defineProperty(exports,"__esModule",{value:!0}),exports.MavenContributions=void 0,function(MavenContributions){MavenContributions.Caching="maven.caching",MavenContributions.Http="maven.http",MavenContributions.DependencyProperties="maven.dependencyProperties",MavenContributions.ApiUrl="maven.apiUrl",MavenContributions.FilePatterns="maven.files",MavenContributions.OnSaveChangesTask="maven.onSaveChanges",MavenContributions.prereleaseTagFilter="maven.prereleaseTagFilter"}(MavenContributions||(exports.MavenContributions=MavenContributions={}))},2101:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},3549:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},1896:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0})},5681:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.MavenConfig=void 0;const guards_1=__webpack_require__(6202),clients_1=__webpack_require__(6502),utils_1=__webpack_require__(7130),eMavenContributions_1=__webpack_require__(8541),ctorParam=(0,utils_1.nameOf)();exports.MavenConfig=class{config;caching;http;constructor(config,caching,http){this.config=config,this.caching=caching,this.http=http,(0,guards_1.throwUndefinedOrNull)(ctorParam.config,config),(0,guards_1.throwUndefinedOrNull)(ctorParam.caching,caching),(0,guards_1.throwUndefinedOrNull)(ctorParam.http,http)}get fileMatcher(){return{language:"xml",scheme:"file",pattern:this.filePatterns,exclude:""}}get filePatterns(){return this.config.get(eMavenContributions_1.MavenContributions.FilePatterns)}get dependencyProperties(){return this.config.get(eMavenContributions_1.MavenContributions.DependencyProperties)}get apiUrl(){return clients_1.UrlUtils.ensureEndSlash(this.config.get(eMavenContributions_1.MavenContributions.ApiUrl))}get onSaveChangesTask(){return this.config.get(eMavenContributions_1.MavenContributions.OnSaveChangesTask)}get prereleaseTagFilter(){return this.config.get(eMavenContributions_1.MavenContributions.prereleaseTagFilter)}}},4760:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.configureContainer=void 0;const serviceUtils_1=__webpack_require__(2379);exports.configureContainer=async function(serviceProvider,services){return(0,serviceUtils_1.addCachingOptions)(services),(0,serviceUtils_1.addHttpOptions)(services),(0,serviceUtils_1.addMavenConfig)(services),(0,serviceUtils_1.addProcessClient)(services),(0,serviceUtils_1.addCliClient)(services),(0,serviceUtils_1.addHttpClient)(services),(0,serviceUtils_1.addMavenClient)(services),(0,serviceUtils_1.addSuggestionProvider)(services),await services.buildChild("maven",serviceProvider)}},4983:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.MavenSuggestionProvider=void 0;const guards_1=__webpack_require__(6202),clients_1=__webpack_require__(6502),packages_1=__webpack_require__(7074),mavenParser_1=__webpack_require__(5524);exports.MavenSuggestionProvider=class{client;mvnCli;config;logger;name="maven";constructor(client,mvnCli,config,logger){this.client=client,this.mvnCli=mvnCli,this.config=config,this.logger=logger,(0,guards_1.throwUndefinedOrNull)("client",client),(0,guards_1.throwUndefinedOrNull)("mvnCli",mvnCli),(0,guards_1.throwUndefinedOrNull)("config",config),(0,guards_1.throwUndefinedOrNull)("logger",logger)}parseDependencies(packagePath,packageText){return(0,mavenParser_1.parseMavenPackagesXml)(packageText,this.config.dependencyProperties).filter((x=>x.hasType(packages_1.PackageDescriptorType.version))).map((packageDesc=>{const nameDesc=packageDesc.getType(packages_1.PackageDescriptorType.name),versionDesc=packageDesc.getType(packages_1.PackageDescriptorType.version);return new packages_1.PackageDependency((0,packages_1.createPackageResource)(nameDesc.name,versionDesc.version,packagePath),nameDesc.nameRange,versionDesc.versionRange,packageDesc)}))}async preFetchSuggestions(projectPath,packagePath){return{repositories:(await this.mvnCli.fetchRepositories(packagePath)).filter((repo=>repo.protocol===clients_1.UrlUtils.RegistryProtocols.https))}}}},5524:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.mapChildrenToDescriptor=exports.extractDependenciesFromNodes=exports.parseMavenPackagesXml=void 0;const packages_1=__webpack_require__(7074),mavenParserTypeFactory_1=__webpack_require__(6518);function extractDependenciesFromNodes(doc,propertyNodes,includePropNames){const matchedDependencies=[],includeNodes=includePropNames.map((n=>doc.findExactPaths(n))).flat();for(const node of includeNodes){const childNodes=doc.getChildren(node);if(0===childNodes.length)continue;const packageDesc=mapChildrenToDescriptor(node,childNodes,propertyNodes);packageDesc&&matchedDependencies.push(packageDesc)}return matchedDependencies}function mapChildrenToDescriptor(parentNode,childNodes,propertyNodes){const packageDesc=new packages_1.PackageDescriptor,nameDesc=(0,mavenParserTypeFactory_1.createNameDescFromXmlNodes)(parentNode,childNodes,propertyNodes);if(!nameDesc)return;const versionDesc=(0,mavenParserTypeFactory_1.createVersionDescFromXmlNodes)(childNodes,propertyNodes);return versionDesc?(packageDesc.addType(nameDesc),packageDesc.addType(versionDesc),packageDesc):void 0}exports.parseMavenPackagesXml=function(xml,includePropertyNames){if(0===includePropertyNames.length)return[];const document=new packages_1.XmlDoc;if(document.parse(xml),document.errors.length>0)return[];const propertyNodes=document.findPathsStartsWith("project.properties");return extractDependenciesFromNodes(document,propertyNodes,includePropertyNames)},exports.extractDependenciesFromNodes=extractDependenciesFromNodes,exports.mapChildrenToDescriptor=mapChildrenToDescriptor},6518:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.createVersionDescFromXmlNodes=exports.createNameDescFromXmlNodes=void 0;const packages_1=__webpack_require__(7074);function nodeOrPropertyNode(node,propertyNodes){let propertyNode=null;const nodeText=node.text.trim();if(nodeText.startsWith("${")&&nodeText.endsWith("}")){const propertyName=nodeText.substring(2,nodeText.length-1);[propertyNode]=propertyNodes.filter((x=>x.name===propertyName))}return propertyNode||node}exports.createNameDescFromXmlNodes=function(parentNode,nodes,propertyNodes){let[groupIdNode]=nodes.filter((x=>"groupId"===x.name));if(!groupIdNode)return;let[artifactIdNode]=nodes.filter((x=>"artifactId"===x.name));if(!artifactIdNode)return;groupIdNode=nodeOrPropertyNode(groupIdNode,propertyNodes),artifactIdNode=nodeOrPropertyNode(artifactIdNode,propertyNodes);const nameRange={start:parentNode.tagOpenStart,end:parentNode.tagOpenStart};return{type:packages_1.PackageDescriptorType.name,name:`${groupIdNode.text}:${artifactIdNode.text}`,nameRange}},exports.createVersionDescFromXmlNodes=function(nodes,propertyNodes){let[versionNode]=nodes.filter((x=>"version"===x.name));if(!versionNode)return;versionNode=nodeOrPropertyNode(versionNode,propertyNodes);const versionRange={start:versionNode.textStart,end:versionNode.textEnd},version=versionNode.text;return{type:packages_1.PackageDescriptorType.version,version,versionRange}}},2626:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractReposUrlsFromXml=exports.getVersionsFromPackageXml=void 0;const packages_1=__webpack_require__(7074);exports.getVersionsFromPackageXml=function(packageXml){const document=new packages_1.XmlDoc;document.parse(packageXml);const versionNodes=document.findExactPaths("metadata.versioning.versions.version");return 0===versionNodes.length?[]:versionNodes.map((x=>x.text))},exports.extractReposUrlsFromXml=function(stdout){const xmlString=/<\?xml(.+\r?\n?)+\/settings>/gm.exec(stdout.toString())[0],doc=new packages_1.XmlDoc;if(doc.parse(xmlString),doc.errors.length>0)return[];const[localRepository]=doc.findExactPaths("settings.localRepository"),results=[localRepository.text];return doc.findExactPaths("settings.profiles.profile.repositories.repository.url").forEach((node=>{results.push(node.text)})),results}},2379:(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.addSuggestionProvider=exports.addMavenClient=exports.addHttpClient=exports.addCliClient=exports.addProcessClient=exports.addMavenConfig=exports.addHttpOptions=exports.addCachingOptions=void 0;const caching_1=__webpack_require__(2304),http_1=__webpack_require__(5829),utils_1=__webpack_require__(7130),http_2=__webpack_require__(8128),process_1=__webpack_require__(7422),mavenClient_1=__webpack_require__(2701),mvnCli_1=__webpack_require__(8056),eMavenContributions_1=__webpack_require__(8541),mavenConfig_1=__webpack_require__(5681),mavenSuggestionProvider_1=__webpack_require__(4983);exports.addCachingOptions=function(services){services.addSingleton((0,utils_1.nameOf)().mavenCachingOpts,(container=>new caching_1.CachingOptions(container.appConfig,eMavenContributions_1.MavenContributions.Caching,"caching")))},exports.addHttpOptions=function(services){services.addSingleton((0,utils_1.nameOf)().mavenHttpOpts,(container=>new http_1.HttpOptions(container.appConfig,eMavenContributions_1.MavenContributions.Http,"http")))},exports.addMavenConfig=function(services){services.addSingleton((0,utils_1.nameOf)().mavenConfig,(container=>new mavenConfig_1.MavenConfig(container.appConfig,container.mavenCachingOpts,container.mavenHttpOpts)))},exports.addProcessClient=function(services){const serviceName=(0,utils_1.nameOf)().mvnProcess;services.addSingleton(serviceName,(container=>(0,process_1.createProcessClient)(container.processesCache,container.mavenCachingOpts,container.logger.child({namespace:serviceName}))))},exports.addCliClient=function(services){const serviceName=(0,utils_1.nameOf)().mvnCli;services.addSingleton(serviceName,(container=>new mvnCli_1.MvnCli(container.mavenConfig,container.mvnProcess,container.logger.child({namespace:serviceName}))))},exports.addHttpClient=function(services){const serviceName=(0,utils_1.nameOf)().mavenHttpClient;services.addSingleton(serviceName,(container=>(0,http_2.createHttpClient)({caching:container.mavenCachingOpts,http:container.mavenHttpOpts},container.logger.child({namespace:serviceName}))))},exports.addMavenClient=function(services){const serviceName=(0,utils_1.nameOf)().mavenClient;services.addSingleton(serviceName,(container=>new mavenClient_1.MavenClient(container.mavenConfig,container.mavenHttpClient,container.logger.child({namespace:serviceName}))))},exports.addSuggestionProvider=function(services){services.addScoped((0,utils_1.nameOf)().suggestionProvider,(container=>new mavenSuggestionProvider_1.MavenSuggestionProvider(container.mavenClient,container.mvnCli,container.mavenConfig,container.logger.child({namespace:"mavenSuggestionProvider"}))))}}};
//# sourceMappingURL=601.bundle.js.map